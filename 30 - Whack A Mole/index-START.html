<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Whack A Mole!</title>
    <link
      href="https://fonts.googleapis.com/css?family=Amatic+SC:400,700"
      rel="stylesheet"
      type="text/css"
    />
    <link rel="stylesheet" href="style.css" />
    <link rel="icon" href="https://fav.farm/ðŸ”¥" />
  </head>
  <body>
    <h1>Whack-a-mole! <span class="score">0</span></h1>
    <button onClick="startGame()">Start!</button>

    <div class="game">
      <div class="hole hole1">
        <div class="mole"></div>
      </div>
      <div class="hole hole2">
        <div class="mole"></div>
      </div>
      <div class="hole hole3">
        <div class="mole"></div>
      </div>
      <div class="hole hole4">
        <div class="mole"></div>
      </div>
      <div class="hole hole5">
        <div class="mole"></div>
      </div>
      <div class="hole hole6">
        <div class="mole"></div>
      </div>
    </div>

    <script>
      const holes = document.querySelectorAll(".hole");
      const scoreBoard = document.querySelector(".score");
      const moles = document.querySelectorAll(".mole");

      // æ¸¸æˆæ—¶é—´ç”Ÿæˆ
      // randomç»“æžœ * max-minï¼Œè¿™æ ·è¿”å›žçš„èŒƒå›´å°±å˜æˆäº†[0,max - min)
      // å† + min ï¼Œè¿”å›žçš„èŒƒå›´å°±å˜æˆäº† [min,max)
      function randomTime(min, max) {
        return Math.round(Math.random() * (max - min) + min);
      }

      // ç”Ÿæˆéšæœºçš„éœ€è¦æ·»åŠ  up çš„ hole
      // è¿”å›žçš„èŒƒå›´æ˜¯[0,holes.length)
      let lastHole;
      function randomHole(holes) {
        const holeId = Math.floor(Math.random() * holes.length);
        const hole = holes[holeId];
        if (hole === lastHole) {
          return randomHole(holes);
        }
        lastHole = hole;
        return hole;
      }

      // ç»™ç”Ÿæˆçš„holeæ·»åŠ upæ ·å¼
      let isGaming = true;
      // å½“ isGaming ä¸º trueï¼Œè¯´æ˜Žæ¸¸æˆæ­£åœ¨è¿›è¡Œä¸­
      // å½“ isGaming ä¸º falseï¼Œè¯´æ˜Žæ¸¸æˆå·²ç»ç»“æŸ
      function moleUp() {
        // è®¾å®šmoleæ¶ˆå¤±çš„æ—¶é—´
        const time = randomTime(300, 1000);

        // èŽ·å–è¦æ·»åŠ  up çš„ hole å¹¶ä¸ºå…¶æ·»åŠ  up
        const hole = randomHole(holes);
        hole.classList.add("up");

        setTimeout(() => {
          // ç§»é™¤upä½¿moleæ¶ˆå¤±
          hole.classList.remove("up");
          if (isGaming) {
            // å¦‚æžœæ¸¸æˆè¿˜æ²¡ç»“æŸ
            moleUp(); // ç»§ç»­ç»™éšæœº hole æ·»åŠ  up è®© mole å‡ºçŽ°
          }
        }, time); // åœ¨ç”Ÿæˆçš„timeæ—¶é—´åŽæ‰§è¡Œï¼Œå•ä½æ˜¯ms
      }

      // å½“ç‚¹å‡»startçš„æ—¶å€™å¼€å§‹æ¸¸æˆ
      let score = 0;
      function startGame() {
        // åˆå§‹åŒ– score
        scoreBoard.textContent = 0;
        score = 0;
        // æŠŠæ¸¸æˆçŠ¶æ€è®¾ç½®ä¸ºæœªç»“æŸ
        isGaming = true;
        // ç»™hole 1-6 éšæœºæ·»åŠ  up
        moleUp();
        setTimeout(() => {
          isGaming = false;
        }, 15000);
        // å½“ç‚¹å‡»åˆ°å¯¹åº”çš„moleæ—¶ï¼Œscore + 1
      }

      // è®°å½•åˆ†æ•°
      function recordScore(e) {
        score++;
        this.parentNode.classList.remove("up");
        scoreBoard.textContent = score;
      }

      moles.forEach((mole) => mole.addEventListener("click", recordScore));
    </script>
  </body>
</html>
